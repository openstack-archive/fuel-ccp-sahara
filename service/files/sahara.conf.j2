[DEFAULT]
debug = {{ sahara.debug }}

use_syslog = false
use_stderr = true

use_neutron = true
plugins = {{ sahara.plugins | join(',') }}

{% if sahara.tls.enabled %}
host = 127.0.0.1
{% else %}
host = {{ network_topology["private"]["address"] }}
{% endif %}
port = {{ sahara.port.cont }}

{% if sahara.tls.enabled %}
#[oslo_middleware]
#enable_proxy_headers_parsing = true
#
{% endif %}

{% if keystone.tls.enabled %}
[keystone]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

{% if cinder.tls.enabled %}
[cinder]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

{% if heat.tls.enabled %}
[heat]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

{% if glance.tls.enabled %}
[glance]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

{% if nova.tls.enabled %}
[nova]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

{% if neutron.tls.enabled %}
[neutron]
ca_file = /opt/ccp/etc/tls/ca.pem
{% endif %}

periodic_coordinator_backend_url = memcached://{{ address("memcached", memcached.port) }}

heat_enable_wait_condition = {{ sahara.enable_wait_condition }}

[database]
connection = mysql+pymysql://{{ sahara.db.username }}:{{ sahara.db.password }}@{{ address("database") }}/{{ sahara.db.name }}{% if db.tls.enabled %}?ssl_ca=/opt/ccp/etc/tls/ca.pem{% endif %}
max_retries = -1

{{ keystone_authtoken.keystone_authtoken(sahara.auth.user, sahara.auth.password) }}

# sahara trustor user
admin_password = {{ sahara.auth.password }}
admin_user = {{ sahara.auth.user }}
admin_tenant_name = {{ service_account.project }}

[oslo_messaging_notifications]
driver = noop

{{ oslo_messaging[messaging.backend.rpc]('rpc_config') }}
